<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bday PDF Creator</title>
    <link rel="icon" type="image/svg+xml" href="src/iconlogo.svg">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Full-Screen Welcome Modal (Photoshop-inspired) -->
    <div class="welcome-modal" id="welcomeModal">
        <img class="glitter" src="https://assets.codepen.io/13471/noise-base.png" loading=lazy>
        <img class="glitter" src="https://assets.codepen.io/13471/noise-top.png" loading=lazy>
        <div class="welcome-content">
            <!-- Logo and Title -->
            <div class="welcome-header">
                <div class="welcome-logo">
                    <img src="src/iconlogo.svg" alt="BdayPDF Creator Icon" class="logo-icon-large">
                    <img src="src/textlogo.svg" alt="BdayPDF Creator Text" class="text-logo-large">
                </div>
                <p class="welcome-subtitle">Gerador de Cart√µes de Felicita√ß√£o</p>
            </div>

            <!-- Upload Areas Grid -->
            <div id="upload-grid" class="upload-grid">
                <!-- Excel Upload Area -->
                <div class="upload-card" id="welcomeExcelCard">
                    <div class="upload-card-header">
                        <h2 class="upload-card-title">Excel</h2>
                    </div>
                    <div class="upload-card-body">
                        <div class="upload-dropzone" id="welcomeExcelDropzone">
                            <div class="dropzone-icon">
                                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA1CAYAAADh5qNwAAAACXBIWXMAAAsTAAALEwEAmpwYAAADZUlEQVR4nO3aS2jTcBwH8Hrx4kmci/jWsYsXXyAePMiGB3G7uYMoguKyudfFQX2B6BA3D+6wiQdFDyrIZCKCqIdmHZ2be7MpPta6Ura1S5r/v83W9d38JNENdenov02ytPQH38ufJvTTJP/88m9MpnzlQPn9/iKMcQ1CyKxFWJZt1BWEMS5HCAURQqBVZmZmwOVyDekCAoA1CCG3lqBFlN1u1weGENqmNehvlC4wjuOK9Ub9gQ3nHMquJYxbRZRmMC4JKhaLgSiKRAmHw8QoTWBcElQoFIJIJEKUQCCQFOV2u5OipDidzuGsO/04jlsRpSqM0wklxePxgMPh0B7G6YhaDMuyMDs7mzQej6dcE5R0fSwsLBBlbm5OFTTG+IQmKGk2I61oNGpsFPq9c6KodXpiLVFq5Z1rEOrHHsHZkbaUsr/HbCtk6A6KoZ9TDN2wp6NiraFQnc4e2MRUAcXQaafQUvnSUKhTQ60ZgSgpFlrcbru43jBt0vH+28u+5NH+m1Ax2gqH+q4ujW3uqoaTo/fk8S1d1cu2KbBWFWeMCgaD8pckyfz8fEqosuEWiIsJmArxsLu7Xh5rcnTKM+gzt03xaKmCUitKKCntrvcy4uGUBY58ugHhRBQmgywUdTdkL2qbtQa+BqYhIYoyJpqIwbFB5c9S2YKSUjrQJKOkap58veJkUaAGShAE+Rohid/vJ0I1fn+61I0w6MuKU3+BGii12qRkqMN91yEQDwMbEaDf75C3vzbxQluUz+eTjxZJlFolJZQ0ZQ8JP0EEEU6PtcG+j2bwRQMQScSgZOBWdl5TdyffyEfm8XTX0tj5zw/ksR8BN+yw1mYf6kDvZfnGu9Va88/4wd4r8rjhUedG7qvQJlXGqA9n1mWMkhZSpFaJJFIX8v9+bNPjsNNalxGqkKHvpAzSAyVl3OOA9om30PLtVUopG2h+QjG0eaOlspGyXCghAulx+uXsQyLKo5B2qHRuvqRRaquQ0VaT0inpx9MNJaTR0JIm2Tohzl9TCpVHoSxHhdL4f4o00mKN0uMK1gqVzhIZaeLxuL6zH8rF0w/lUchYKKTTGy8k8Xq9pVnxblKq4Xk+LAjCBlOmhTEu0/otshRBcZ7n60xqlc/n2+X1emt5nm9ejSCELmGM96oGypfJWPUL5sWswEbVVLEAAAAASUVORK5CYII=" alt="Excel Icon">
                            </div>
                            <p class="dropzone-text">Arraste seu arquivo Excel aqui</p>
                            <p class="dropzone-subtext">ou clique para selecionar</p>
                            <input type="file" id="welcomeExcelInput" accept=".xlsx,.xls" hidden>
                            <button class="btn-upload" onclick="document.getElementById('welcomeExcelInput').click()">
                                Selecionar Arquivo
                            </button>
                        </div>
                        <div class="upload-status" id="welcomeExcelStatus" style="display: none;">
                            <div class="status-icon success-icon">‚úì</div>
                            <div class="status-info">
                                <p class="status-filename" id="welcomeExcelFilename"></p>
                                <p class="status-size" id="welcomeExcelSize"></p>
                            </div>
                            <button class="btn-remove" onclick="resetWelcomeExcel()">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 48 48">
                                    <linearGradient id="btnRemoveExcelGr1" x1="7.534" x2="27.557" y1="7.534" y2="27.557" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#f44f5a"></stop><stop offset=".443" stop-color="#ee3d4a"></stop><stop offset="1" stop-color="#e52030"></stop></linearGradient><path fill="url(#btnRemoveExcelGr1)" d="M42.42,12.401c0.774-0.774,0.774-2.028,0-2.802L38.401,5.58c-0.774-0.774-2.028-0.774-2.802,0	L24,17.179L12.401,5.58c-0.774-0.774-2.028-0.774-2.802,0L5.58,9.599c-0.774,0.774-0.774,2.028,0,2.802L17.179,24L5.58,35.599	c-0.774,0.774-0.774,2.028,0,2.802l4.019,4.019c0.774,0.774,2.028,0.774,2.802,0L42.42,12.401z"></path><linearGradient id="btnRemoveExcelGr2" x1="27.373" x2="40.507" y1="27.373" y2="40.507" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#a8142e"></stop><stop offset=".179" stop-color="#ba1632"></stop><stop offset=".243" stop-color="#c21734"></stop></linearGradient><path fill="url(#btnRemoveExcelGr2)" d="M24,30.821L35.599,42.42c0.774,0.774,2.028,0.774,2.802,0l4.019-4.019	c0.774-0.774,0.774-2.028,0-2.802L30.821,24L24,30.821z"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="upload-card-footer">
                        <p class="upload-hint">Formatos aceitos: .xlsx, .xls</p>
                    </div>
                </div>

                <!-- Template Upload Area -->
                <div class="upload-card" id="welcomeTemplateCard">
                    <div class="upload-card-header">
                        <h2 class="upload-card-title">Template</h2>
                        <!-- Use Default Template Checkbox -->
                        <label class="checkbox-label checkbox-header">
                            <input type="checkbox" id="useDefaultTemplate" onchange="toggleDefaultTemplate()">
                            <span>Usar padr√£o</span>
                        </label>
                    </div>
                    <div class="upload-card-body">
                        <div class="upload-dropzone" id="welcomeTemplateDropzone">
                            <div class="dropzone-icon">
                                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA1CAYAAADh5qNwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC4klEQVR4nO3aMU/bQBQH8Kjd+ymKurR7h46ou20FlAxAQV0oDAFBBwYGGCoRmJAygIQAUSEGJKZWdGBgQFRIfAAjAUIojnnnQCCOfXf2q+yoCRWtmgSfDcFP+i+nk3I/3z3HwyUScbVp6brecXFx8YkQ8llENE3LhAoCAAUALEIIisr5+TmenJzshQJCxOcAACJBv1GqqoYD03W9QzToNioUmGEYb8JGeTk9Pd1vO5RQmBEhShUFixqlqioeHx//bBmAk5PPqCR9tWWZUVnGIGKn01ja2roXSr3Py4NK0tugMH/Aenv/i9J1HY+OjoKHMUV5X1uMoiBfXa1mYQHZ0JA/zsbHq2PLy8hnZ5GmUtX5qVR9vpeZmTqsu7uhI5jP54OHsduoZBKRUuS5HPKVFXQJQTY8jHxpCd2DAx/qfP+Obj6PdGAAaV8fYqlUnZ/LIZuaahrlBQCwUCigpmn/DAB0to4ql2sLc7a3kc/P+yhnY6M2ztfX0dnc9FGurv/9CDaBahDe2TrKtpFns/6TdwGQjYzcRWWz6OzsVHeKc3Q1zQ+fm3ugKEr9XeBra8jGxqqI2yhFQWd3F/ni4iPaqXL9+NV2xuupszN09vf9fvJQtKvrkaAUBdno6N0F9vf7u+YdRdrTUx9PJpFlMg8PZSWTr2xZdoP+n7IGB6NDeWVL0gdblr/ZkvTDi5VO75kTE9hypqexeHgYLSqqb78YBTHqbsUoEqPwwaFKpRJaliU019fX4aIopSi6OOfhoorFIt7c3AjN5eVl3FMN15NClctlZIwJjWma7feiYIyFizIMA6+uroTGMIy4pxquJ4WqVCrouq7QWJYVLsr7QdFFKQ3/+HmNLDIk7qmAUN73n8iQsFG2bbdfT5mmiY7jCE2lUol7quGKUeSRoPSQbrw0E8Mw3j2Ku0lNxASAF4kgbpERQipRgwCAEUI+JoKqQqHwEgCGAOBLRMkQQl4HBoorEV39Ao9Z9ZpvVIYRAAAAAElFTkSuQmCC" alt="PDF Icon">
                            </div>
                            <p class="dropzone-text">Arraste seu template PDF aqui</p>
                            <p class="dropzone-subtext">ou clique para selecionar</p>
                            <input type="file" id="welcomeTemplateInput" accept=".pdf" hidden>
                            <button class="btn-upload" onclick="document.getElementById('welcomeTemplateInput').click()">
                                Selecionar Arquivo
                            </button>
                        </div>
                        <div class="upload-status" id="welcomeTemplateStatus" style="display: none;">
                            <div class="status-icon success-icon">‚úì</div>
                            <div class="status-info">
                                <p class="status-filename" id="welcomeTemplateFilename"></p>
                                <p class="status-size" id="welcomeTemplateSize"></p>
                            </div>
                            <button class="btn-remove" onclick="resetWelcomeTemplate()">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 48 48">
                                    <linearGradient id="btnRemoveTemplateGr1" x1="7.534" x2="27.557" y1="7.534" y2="27.557" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#f44f5a"></stop><stop offset=".443" stop-color="#ee3d4a"></stop><stop offset="1" stop-color="#e52030"></stop></linearGradient><path fill="url(#btnRemoveTemplateGr1)" d="M42.42,12.401c0.774-0.774,0.774-2.028,0-2.802L38.401,5.58c-0.774-0.774-2.028-0.774-2.802,0	L24,17.179L12.401,5.58c-0.774-0.774-2.028-0.774-2.802,0L5.58,9.599c-0.774,0.774-0.774,2.028,0,2.802L17.179,24L5.58,35.599	c-0.774,0.774-0.774,2.028,0,2.802l4.019,4.019c0.774,0.774,2.028,0.774,2.802,0L42.42,12.401z"></path><linearGradient id="btnRemoveTemplateGr2" x1="27.373" x2="40.507" y1="27.373" y2="40.507" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#a8142e"></stop><stop offset=".179" stop-color="#ba1632"></stop><stop offset=".243" stop-color="#c21734"></stop></linearGradient><path fill="url(#btnRemoveTemplateGr2)" d="M24,30.821L35.599,42.42c0.774,0.774,2.028,0.774,2.802,0l4.019-4.019	c0.774-0.774,0.774-2.028,0-2.802L30.821,24L24,30.821z"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="upload-card-footer">
                        <p class="upload-hint">Formato aceito: .pdf</p>
                    </div>
                </div>
            </div>

            <!-- Action Button -->
            <div class="welcome-actions">
                <button class="btn-start" id="btnStart" onclick="startApplication()" disabled>
                    <span>Iniciar Aplica√ß√£o</span>
                </button>
                <p class="welcome-note">Carregue ambos os arquivos para continuar</p>
            </div>
        </div>
    </div>

    <div class="workbench">
        <!-- Header -->
        <header class="workbench-header">
            <div class="header-logo">
                <img src="src/iconlogo.svg" alt="BdayPDF Creator Icon" class="logo-icon">
                <img src="src/textlogo.svg" alt="BdayPDF Creator Text" class="logo-text">
            </div>
            <button class="btn btn-generate" id="generateBatchBtn" onclick="generateAllCards()">
                <span class="btn-icon">‚ö°</span>
                <span>GENERATE BATCH</span>
            </button>
        </header>

        <!-- Main Body -->
        <main class="app-body">
            <!-- Left Toolbar -->
            <aside class="toolbar">
                <div class="toolbar-item" data-tool="select" title="Sele√ß√£o de Campos">
                    <div class="toolbar-icon">üñ±Ô∏è</div>
                    <span class="toolbar-label">Select</span>
                </div>
                <div class="toolbar-item" data-tool="text" title="Edi√ß√£o de Texto">
                    <div class="toolbar-icon">‚úèÔ∏è</div>
                    <span class="toolbar-label">Text</span>
                </div>
                <div class="toolbar-item" data-tool="zoom" title="Zoom">
                    <div class="toolbar-icon">üîç</div>
                    <span class="toolbar-label">Zoom</span>
                </div>
            </aside>

            <!-- Center Canvas -->
            <section class="canvas-area">
                <div class="canvas-container">
                    <div class="canvas-header">
                        <span class="canvas-title">PDF Preview</span>
                        <div class="canvas-zoom-controls">
                            <button class="zoom-btn" onclick="zoomOut()">‚àí</button>
                            <span class="zoom-level" id="zoomLevel">100%</span>
                            <button class="zoom-btn" onclick="zoomIn()">+</button>
                        </div>
                    </div>
                    <div class="canvas-content" id="canvasContent">
                        <!-- PDF Preview Frame -->
                        <iframe id="pdfPreviewFrame" class="pdf-preview-frame"></iframe>
                        <!-- Placeholder when no template is loaded -->
                        <div class="canvas-placeholder" id="canvasPlaceholder">
                            <div class="placeholder-icon">üìÑ</div>
                            <p>Carregue um template PDF para visualizar</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Right Properties Panel -->
            <aside class="properties-panel">
                <!-- Upload Section -->
                <div class="panel-section">
                    <h3 class="panel-title">Upload Excel</h3>
                    <div class="upload-box" id="uploadBox">
                        <div class="upload-icon"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA1CAYAAADh5qNwAAAACXBIWXMAAAsTAAALEwEAmpwYAAADZUlEQVR4nO3aS2jTcBwH8Hrx4kmci/jWsYsXXyAePMiGB3G7uYMoguKyudfFQX2B6BA3D+6wiQdFDyrIZCKCqIdmHZ2be7MpPta6Ura1S5r/v83W9d38JNENdenov02ytPQH38ufJvTTJP/88m9MpnzlQPn9/iKMcQ1CyKxFWJZt1BWEMS5HCAURQqBVZmZmwOVyDekCAoA1CCG3lqBFlN1u1weGENqmNehvlC4wjuOK9Ub9gQ3nHMquJYxbRZRmMC4JKhaLgSiKRAmHw8QoTWBcElQoFIJIJEKUQCCQFOV2u5OipDidzuGsO/04jlsRpSqM0wklxePxgMPh0B7G6YhaDMuyMDs7mzQej6dcE5R0fSwsLBBlbm5OFTTG+IQmKGk2I61oNGpsFPq9c6KodXpiLVFq5Z1rEOrHHsHZkbaUsr/HbCtk6A6KoZ9TDN2wp6NiraFQnc4e2MRUAcXQaafQUvnSUKhTQ60ZgSgpFlrcbru43jBt0vH+28u+5NH+m1Ax2gqH+q4ujW3uqoaTo/fk8S1d1cu2KbBWFWeMCgaD8pckyfz8fEqosuEWiIsJmArxsLu7Xh5rcnTKM+gzt03xaKmCUitKKCntrvcy4uGUBY58ugHhRBQmgywUdTdkL2qbtQa+BqYhIYoyJpqIwbFB5c9S2YKSUjrQJKOkap58veJkUaAGShAE+Rohid/vJ0I1fn+61I0w6MuKU3+BGii12qRkqMN91yEQDwMbEaDf75C3vzbxQluUz+eTjxZJlFolJZQ0ZQ8JP0EEEU6PtcG+j2bwRQMQScSgZOBWdl5TdyffyEfm8XTX0tj5zw/ksR8BN+yw1mYf6kDvZfnGu9Va88/4wd4r8rjhUedG7qvQJlXGqA9n1mWMkhZSpFaJJFIX8v9+bNPjsNNalxGqkKHvpAzSAyVl3OOA9om30PLtVUopG2h+QjG0eaOlspGyXCghAulx+uXsQyLKo5B2qHRuvqRRaquQ0VaT0inpx9MNJaTR0JIm2Tohzl9TCpVHoSxHhdL4f4o00mKN0uMK1gqVzhIZaeLxuL6zH8rF0w/lUchYKKTTGy8k8Xq9pVnxblKq4Xk+LAjCBlOmhTEu0/otshRBcZ7n60xqlc/n2+X1emt5nm9ejSCELmGM96oGypfJWPUL5sWswEbVVLEAAAAASUVORK5CYII=" alt="Excel Icon"></div>
                        <p>Arraste ou clique</p>
                        <input type="file" id="fileInput" accept=".xlsx,.xls" hidden>
                        <button class="btn btn-sm" onclick="document.getElementById('fileInput').click()">
                            Selecionar
                        </button>
                    </div>
                    <div class="file-info" id="fileInfo" style="display: none;">
                        <div class="file-icon"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA1CAYAAADh5qNwAAAACXBIWXMAAAsTAAALEwEAmpwYAAADZUlEQVR4nO3aS2jTcBwH8Hrx4kmci/jWsYsXXyAePMiGB3G7uYMoguKyudfFQX2B6BA3D+6wiQdFDyrIZCKCqIdmHZ2be7MpPta6Ura1S5r/v83W9d38JNENdenov02ytPQH38ufJvTTJP/88m9MpnzlQPn9/iKMcQ1CyKxFWJZt1BWEMS5HCAURQqBVZmZmwOVyDekCAoA1CCG3lqBFlN1u1weGENqmNehvlC4wjuOK9Ub9gQ3nHMquJYxbRZRmMC4JKhaLgSiKRAmHw8QoTWBcElQoFIJIJEKUQCCQFOV2u5OipDidzuGsO/04jlsRpSqM0wklxePxgMPh0B7G6YhaDMuyMDs7mzQej6dcE5R0fSwsLBBlbm5OFTTG+IQmKGk2I61oNGpsFPq9c6KodXpiLVFq5Z1rEOrHHsHZkbaUsr/HbCtk6A6KoZ9TDN2wp6NiraFQnc4e2MRUAcXQaafQUvnSUKhTQ60ZgSgpFlrcbru43jBt0vH+28u+5NH+m1Ax2gqH+q4ujW3uqoaTo/fk8S1d1cu2KbBWFWeMCgaD8pckyfz8fEqosuEWiIsJmArxsLu7Xh5rcnTKM+gzt03xaKmCUitKKCntrvcy4uGUBY58ugHhRBQmgywUdTdkL2qbtQa+BqYhIYoyJpqIwbFB5c9S2YKSUjrQJKOkap58veJkUaAGShAE+Rohid/vJ0I1fn+61I0w6MuKU3+BGii12qRkqMN91yEQDwMbEaDf75C3vzbxQluUz+eTjxZJlFolJZQ0ZQ8JP0EEEU6PtcG+j2bwRQMQScSgZOBWdl5TdyffyEfm8XTX0tj5zw/ksR8BN+yw1mYf6kDvZfnGu9Va88/4wd4r8rjhUedG7qvQJlXGqA9n1mWMkhZSpFaJJFIX8v9+bNPjsNNalxGqkKHvpAzSAyVl3OOA9om30PLtVUopG2h+QjG0eaOlspGyXCghAulx+uXsQyLKo5B2qHRuvqRRaquQ0VaT0inpx9MNJaTR0JIm2Tohzl9TCpVHoSxHhdL4f4o00mKN0uMK1gqVzhIZaeLxuL6zH8rF0w/lUchYKKTTGy8k8Xq9pVnxblKq4Xk+LAjCBlOmhTEu0/otshRBcZ7n60xqlc/n2+X1emt5nm9ejSCELmGM96oGypfJWPUL5sWswEbVVLEAAAAASUVORK5CYII=" alt="Excel Icon"></div>
                        <div class="file-details">
                            <p class="file-name" id="fileName"></p>
                            <p class="file-size" id="fileSize"></p>
                        </div>
                        <button class="btn-remove" style="width: 26px; height: 26px; min-width: 10px; min-height: 10px; padding: 3px 7px;" onclick="resetUpload()">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 48 48" style="width: 16px; height: 16px;">
                                <linearGradient id="btnRemoveExcelMainGr1" x1="7.534" x2="27.557" y1="7.534" y2="27.557" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#f44f5a"></stop><stop offset=".443" stop-color="#ee3d4a"></stop><stop offset="1" stop-color="#e52030"></stop></linearGradient><path fill="url(#btnRemoveExcelMainGr1)" d="M42.42,12.401c0.774-0.774,0.774-2.028,0-2.802L38.401,5.58c-0.774-0.774-2.028-0.774-2.802,0	L24,17.179L12.401,5.58c-0.774-0.774-2.028-0.774-2.802,0L5.58,9.599c-0.774,0.774-0.774,2.028,0,2.802L17.179,24L5.58,35.599	c-0.774,0.774-0.774,2.028,0,2.802l4.019,4.019c0.774,0.774,2.028,0.774,2.802,0L42.42,12.401z"></path><linearGradient id="btnRemoveExcelMainGr2" x1="27.373" x2="40.507" y1="27.373" y2="40.507" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#a8142e"></stop><stop offset=".179" stop-color="#ba1632"></stop><stop offset=".243" stop-color="#c21734"></stop></linearGradient><path fill="url(#btnRemoveExcelMainGr2)" d="M24,30.821L35.599,42.42c0.774,0.774,2.028,0.774,2.802,0l4.019-4.019	c0.774-0.774,0.774-2.028,0-2.802L30.821,24L24,30.821z"></path>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- PDF Template Section -->
                <div class="panel-section">
                    <div class="panel-section-header">
                        <h3 class="panel-title">Template PDF</h3>
                        <!-- Use Default Template Checkbox -->
                        <label class="checkbox-label checkbox-header">
                            <input type="checkbox" id="useDefaultTemplateMain" onchange="toggleDefaultTemplateMain()">
                            <span>Usar padr√£o</span>
                        </label>
                    </div>
                    <div class="upload-box" id="pdfTemplateBox">
                        <div class="upload-icon"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA1CAYAAADh5qNwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC4klEQVR4nO3aMU/bQBQH8Kjd+ymKurR7h46ou20FlAxAQV0oDAFBBwYGGCoRmJAygIQAUSEGJKZWdGBgQFRIfAAjAUIojnnnQCCOfXf2q+yoCRWtmgSfDcFP+i+nk3I/3z3HwyUScbVp6brecXFx8YkQ8llENE3LhAoCAAUALEIIisr5+TmenJzshQJCxOcAACJBv1GqqoYD03W9QzToNioUmGEYb8JGeTk9Pd1vO5RQmBEhShUFixqlqioeHx//bBmAk5PPqCR9tWWZUVnGIGKn01ja2roXSr3Py4NK0tugMH/Aenv/i9J1HY+OjoKHMUV5X1uMoiBfXa1mYQHZ0JA/zsbHq2PLy8hnZ5GmUtX5qVR9vpeZmTqsu7uhI5jP54OHsduoZBKRUuS5HPKVFXQJQTY8jHxpCd2DAx/qfP+Obj6PdGAAaV8fYqlUnZ/LIZuaahrlBQCwUCigpmn/DAB0to4ql2sLc7a3kc/P+yhnY6M2ztfX0dnc9FGurv/9CDaBahDe2TrKtpFns/6TdwGQjYzcRWWz6OzsVHeKc3Q1zQ+fm3ugKEr9XeBra8jGxqqI2yhFQWd3F/ni4iPaqXL9+NV2xuupszN09vf9fvJQtKvrkaAUBdno6N0F9vf7u+YdRdrTUx9PJpFlMg8PZSWTr2xZdoP+n7IGB6NDeWVL0gdblr/ZkvTDi5VO75kTE9hypqexeHgYLSqqb78YBTHqbsUoEqPwwaFKpRJaliU019fX4aIopSi6OOfhoorFIt7c3AjN5eVl3FMN15NClctlZIwJjWma7feiYIyFizIMA6+uroTGMIy4pxquJ4WqVCrouq7QWJYVLsr7QdFFKQ3/+HmNLDIk7qmAUN73n8iQsFG2bbdfT5mmiY7jCE2lUol7quGKUeSRoPSQbrw0E8Mw3j2Ku0lNxASAF4kgbpERQipRgwCAEUI+JoKqQqHwEgCGAOBLRMkQQl4HBoorEV39Ao9Z9ZpvVIYRAAAAAElFTkSuQmCC" alt="PDF Icon"></div>
                        <p>Arraste ou clique</p>
                        <input type="file" id="pdfTemplateInput" accept=".pdf" hidden>
                        <button class="btn btn-sm" onclick="document.getElementById('pdfTemplateInput').click()">
                            Selecionar
                        </button>
                    </div>
                    <div class="file-info" id="pdfTemplateInfo" style="display: none;">
                        <div class="file-icon"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA1CAYAAADh5qNwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC4klEQVR4nO3aMU/bQBQH8Kjd+ymKurR7h46ou20FlAxAQV0oDAFBBwYGGCoRmJAygIQAUSEGJKZWdGBgQFRIfAAjAUIojnnnQCCOfXf2q+yoCRWtmgSfDcFP+i+nk3I/3z3HwyUScbVp6brecXFx8YkQ8llENE3LhAoCAAUALEIIisr5+TmenJzshQJCxOcAACJBv1GqqoYD03W9QzToNioUmGEYb8JGeTk9Pd1vO5RQmBEhShUFixqlqioeHx//bBmAk5PPqCR9tWWZUVnGIGKn01ja2roXSr3Py4NK0tugMH/Aenv/i9J1HY+OjoKHMUV5X1uMoiBfXa1mYQHZ0JA/zsbHq2PLy8hnZ5GmUtX5qVR9vpeZmTqsu7uhI5jP54OHsduoZBKRUuS5HPKVFXQJQTY8jHxpCd2DAx/qfP+Obj6PdGAAaV8fYqlUnZ/LIZuaahrlBQCwUCigpmn/DAB0to4ql2sLc7a3kc/P+yhnY6M2ztfX0dnc9FGurv/9CDaBahDe2TrKtpFns/6TdwGQjYzcRWWz6OzsVHeKc3Q1zQ+fm3ugKEr9XeBra8jGxqqI2yhFQWd3F/ni4iPaqXL9+NV2xuupszN09vf9fvJQtKvrkaAUBdno6N0F9vf7u+YdRdrTUx9PJpFlMg8PZSWTr2xZdoP+n7IGB6NDeWVL0gdblr/ZkvTDi5VO75kTE9hypqexeHgYLSqqb78YBTHqbsUoEqPwwaFKpRJaliU019fX4aIopSi6OOfhoorFIt7c3AjN5eVl3FMN15NClctlZIwJjWma7feiYIyFizIMA6+uroTGMIy4pxquJ4WqVCrouq7QWJYVLsr7QdFFKQ3/+HmNLDIk7qmAUN73n8iQsFG2bbdfT5mmiY7jCE2lUol7quGKUeSRoPSQbrw0E8Mw3j2Ku0lNxASAF4kgbpERQipRgwCAEUI+JoKqQqHwEgCGAOBLRMkQQl4HBoorEV39Ao9Z9ZpvVIYRAAAAAElFTkSuQmCC" alt="PDF Icon"></div>
                        <div class="file-details">
                            <p class="file-name" id="pdfTemplateName"></p>
                            <p class="file-size" id="pdfTemplateSize"></p>
                        </div>
                        <button class="btn-remove" style="width: 26px; height: 26px; min-width: 10px; min-height: 10px; font-size: 15px; padding: 3px 7px;" onclick="resetPDFTemplate()">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 48 48" style="width: 16px; height: 16px;">
                                <linearGradient id="btnRemoveTemplateMainGr1" x1="7.534" x2="27.557" y1="7.534" y2="27.557" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#f44f5a"></stop><stop offset=".443" stop-color="#ee3d4a"></stop><stop offset="1" stop-color="#e52030"></stop></linearGradient><path fill="url(#btnRemoveTemplateMainGr1)" d="M42.42,12.401c0.774-0.774,0.774-2.028,0-2.802L38.401,5.58c-0.774-0.774-2.028-0.774-2.802,0	L24,17.179L12.401,5.58c-0.774-0.774-2.028-0.774-2.802,0L5.58,9.599c-0.774,0.774-0.774,2.028,0,2.802L17.179,24L5.58,35.599	c-0.774,0.774-0.774,2.028,0,2.802l4.019,4.019c0.774,0.774,2.028,0.774,2.802,0L42.42,12.401z"></path><linearGradient id="btnRemoveTemplateMainGr2" x1="27.373" x2="40.507" y1="27.373" y2="40.507" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#a8142e"></stop><stop offset=".179" stop-color="#ba1632"></stop><stop offset=".243" stop-color="#c21734"></stop></linearGradient><path fill="url(#btnRemoveTemplateMainGr2)" d="M24,30.821L35.599,42.42c0.774,0.774,2.028,0.774,2.802,0l4.019-4.019	c0.774-0.774,0.774-2.028,0-2.802L30.821,24L24,30.821z"></path>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Field Positioning -->
                <div class="panel-section accordion-section" id="fieldPositioning" style="display: none;">
                    <h3 class="panel-title accordion-toggle">Posicionar Campos <button class="accordion-icon btn-image-action"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABz0lEQVR4nO2Uy0oCURyH5wkSKrIh1G7OTDebNj1Cuyh6g96lFm2SFmVKEGohZRdCky70AC2ilVFUk+I54zRq7dqEnAiamNJyrDM6A/8Pfvvv+8M5DAMAAAAAAAAAwH9xRzOsK5JLuMPoxR1BhNbYUIbaOoMSafdfKY65c7EiwBVGSZriZgSwH2tfTCuVAZFc1i4BzuXb14oAzzoWXGEkWz3AuXJfdsxfzFR9B2ZENEzerAhqDzhwV1vejAhq8guX04bkaUc0RV6jO4r4/0Y0TZ5WRFPl9RGeKMaeDUzq3Z/kV+/Lbf40HXl9RM8Gxj2bmNSzuuWDUrlt6XqKqvxnxDbie2My7o3JxOjqCgg+lDsCkjnyXyK2ZNy3lSdGZjzgwXx5DX4b8f3xPPbGFVJrhi8fapC8hrCnct6dPOZ2FfLbDF0+lG2svD5C2FOwsP9Ifppl5fURAwePeOBAJdX2m7xzNTvJWAHhUOUGEyoeTBTI91leXsN3qHJDyQIaThaJfraQ1xATqnc4VUAjqSLRZht5DfFE9Y4clZDvqETeZyt5Dd+pyo0elzLiydPHP595ZdekCcZOjKeKLWNnz7OdQWmtNXDT1WwfAAAAAGCsyBurBlk9BFq7AAAAAABJRU5ErkJggg==" alt="sort-down"></button></h3>

                    <div class="panel-content">
                        <div class="field-groups">
                            <!-- Nome Field -->
                            <div class="field-group nome">
                                <h4>Nome</h4>
                                <div class="field-coordinates">
                                    <div class="coord-input">
                                        <label>X:</label>
                                        <input type="number" id="nomeX" value="105" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Y:</label>
                                        <input type="number" id="nomeY" value="380" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Tamanho:</label>
                                        <input type="number" id="nomeSize" value="40" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Alinhar:</label>
                                        <select id="nomeAlign">
                                            <option value="left">Esq</option>
                                            <option value="center">Cen</option>
                                            <option value="right">Dir</option>
                                        </select>
                                    </div>
                                    <button class="btn btn-sm btn-primary" onclick="updateFieldPosition('Nome')">Atualizar</button>
                                </div>
                            </div>

                            <!-- Vocativo Field -->
                            <div class="field-group">
                                <h4>Vocativo</h4>
                                <div class="field-coordinates">
                                    <div class="coord-input">
                                        <label>X:</label>
                                        <input type="number" id="vocativoX" value="115" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Y:</label>
                                        <input type="number" id="vocativoY" value="425" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Tamanho:</label>
                                        <input type="number" id="vocativoSize" value="20" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Alinhar:</label>
                                        <select id="vocativoAlign">
                                            <option value="left">Esq</option>
                                            <option value="center">Cen</option>
                                            <option value="right">Dir</option>
                                        </select>
                                    </div>
                                    <button class="btn btn-sm btn-primary" onclick="updateFieldPosition('Vocativo')">Atualizar</button>
                                </div>
                            </div>

                            <!-- Data Field -->
                            <div class="field-group">
                                <h4>Data</h4>
                                <div class="field-coordinates">
                                    <div class="coord-input">
                                        <label>X:</label>
                                        <input type="number" id="dataX" value="765" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Y:</label>
                                        <input type="number" id="dataY" value="490" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Tamanho:</label>
                                        <input type="number" id="dataSize" value="18" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Alinhar:</label>
                                        <select id="dataAlign">
                                            <option value="left">Esq</option>
                                            <option value="center">Cen</option>
                                            <option value="right">Dir</option>
                                        </select>
                                    </div>
                                    <button class="btn btn-sm btn-primary" onclick="updateFieldPosition('Data')">Atualizar</button>
                                </div>
                            </div>
                        </div>

                        <div class="field-list" id="fieldList">
                            <!-- Field positions will be listed here -->
                        </div>
                    </div>
                </div>

                <!-- Data Preview Section -->
                <div class="panel-section" id="dataPreviewSection" style="display: none;">
                    <h3 class="panel-title">Pr√©via dos Dados</h3>
                    <div class="data-summary" id="dataSummary"></div>

                    <!-- Month Tabs -->
                    <div class="month-tabs" id="monthTabs"></div>

                    <!-- Data Table -->
                </div>

                <!-- Results Section -->
                <div class="panel-section" id="resultsPanelSection" style="display: none;">
                    <h3 class="panel-title">‚úÖ Resultados</h3>
                    <div class="results-summary" id="resultsSummary"></div>
                    <div class="results-list" id="resultsList"></div>
                    <div class="panel-actions">
                        <button class="btn btn-primary" onclick="downloadAllCards()">
                            üì¶ Baixar ZIP
                        </button>
                        <button class="btn btn-secondary" onclick="resetAll()">
                            üîÑ Resetar
                        </button>
                    </div>
                </div>
            </aside>
        </main>

        <!-- Progress Modal -->
        <div class="progress-modal" id="progressModal" style="display: none;">
            <div class="progress-content">
                <h3>üîÑ Gerando Cart√µes...</h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p class="progress-text" id="progressText">0 de 0 cart√µes gerados</p>
            </div>
        </div>

        <!-- Month Selection Modal -->
        <div class="month-modal" id="monthModal" style="display: none;">
            <div class="month-modal-content">
                <div class="month-modal-header">
                    <button class="month-modal-nav-btn" onclick="navigateMonth(-1)" title="M√™s Anterior">
                        <img src="https://img.icons8.com/fluency/48/back.png" alt="back" class="nav-icon" />
                    </button>
                    <h3 id="monthModalTitle">Sele√ß√£o de Cart√µes</h3>
                    <button class="month-modal-nav-btn" onclick="navigateMonth(1)" title="Pr√≥ximo M√™s">
                        <img src="https://img.icons8.com/fluency/48/back.png" alt="back" class="nav-icon rotate-180" />
                    </button>
                    <button class="btn-remove" onclick="closeMonthModal()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 48 48">
                            <linearGradient id="btnRemoveMonthModalGr1" x1="7.534" x2="27.557" y1="7.534" y2="27.557" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#f44f5a"></stop><stop offset=".443" stop-color="#ee3d4a"></stop><stop offset="1" stop-color="#e52030"></stop></linearGradient><path fill="url(#btnRemoveMonthModalGr1)" d="M42.42,12.401c0.774-0.774,0.774-2.028,0-2.802L38.401,5.58c-0.774-0.774-2.028-0.774-2.802,0	L24,17.179L12.401,5.58c-0.774-0.774-2.028-0.774-2.802,0L5.58,9.599c-0.774,0.774-0.774,2.028,0,2.802L17.179,24L5.58,35.599	c-0.774,0.774-0.774,2.028,0,2.802l4.019,4.019c0.774,0.774,2.028,0.774,2.802,0L42.42,12.401z"></path><linearGradient id="btnRemoveMonthModalGr2" x1="27.373" x2="40.507" y1="27.373" y2="40.507" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#a8142e"></stop><stop offset=".179" stop-color="#ba1632"></stop><stop offset=".243" stop-color="#c21734"></stop></linearGradient><path fill="url(#btnRemoveMonthModalGr2)" d="M24,30.821L35.599,42.42c0.774,0.774,2.028,0.774,2.802,0l4.019-4.019	c0.774-0.774,0.774-2.028,0-2.802L30.821,24L24,30.821z"></path>
                        </svg>
                    </button>
                </div>
                <div class="month-modal-body">
                    <div class="month-modal-summary" id="monthModalSummary"></div>
                    <div class="month-modal-actions">
                        <button class="btn btn-sm btn-secondary" onclick="selectAllInModal()">Selecionar Todos</button>
                        <button class="btn btn-sm btn-secondary" onclick="deselectAllInModal()">Desmarcar Todos</button>
                    </div>
                    <div class="month-modal-table-container">
                        <table class="month-modal-table">
                            <thead>
                                <tr>
                                    <th class="checkbox-column">
                                        <input type="checkbox" id="selectAllModal" onchange="toggleSelectAllModal()">
                                    </th>
                                    <th>Nome</th>
                                    <th>Vocativo</th>
                                    <th>Data</th>
                                    <th>A√ß√£o</th>
                                </tr>
                            </thead>
                            <tbody id="monthModalTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="month-modal-footer">
                    <button class="btn btn-success" onclick="saveModalSelections()">
                        <img src="https://img.icons8.com/fluency/48/checkmark--v1.png" alt="checkmark--v1"
                            class="btn-icon-img" />
                        <span>OK</span>
                    </button>
                    <button class="btn btn-primary" onclick="downloadSelectedFromModal()">
                        <img src="https://img.icons8.com/fluency/48/downloading-updates.png" alt="downloading-updates"
                            class="btn-icon-img" />
                        <span>Baixar Selecionados</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Alert Container -->
    <div class="alert-container" id="alertContainer"></div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://unpkg.com/downloadjs@1.4.7/download.min.js"></script>
    <script src="script.js"></script>
</body>
</html>