<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bday PDF Creator</title>
    <link rel="icon" type="image/svg+xml" href="src/iconlogo.svg">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Full-Screen Welcome Modal (Photoshop-inspired) -->
    <div class="welcome-modal" id="welcomeModal">
        <img class="glitter" src="https://assets.codepen.io/13471/noise-base.png" loading=lazy>
        <img class="glitter" src="https://assets.codepen.io/13471/noise-top.png" loading=lazy>
        <div class="welcome-content">
            <!-- Logo and Title -->
            <div class="welcome-header">
                <div class="welcome-logo">
                    <img src="src/iconlogo.svg" alt="BdayPDF Creator Icon" class="logo-icon-large">
                    <img src="src/textlogo.svg" alt="BdayPDF Creator Text" class="text-logo-large">
                </div>
                <p class="welcome-subtitle">Gerador de Cart√µes de Felicita√ß√£o</p>
            </div>

            <!-- Upload Areas Grid -->
            <div id="upload-grid" class="upload-grid">
                <!-- Excel Upload Area -->
                <div class="upload-card" id="welcomeExcelCard">
                    <div class="upload-card-header">
                        <h2 class="upload-card-title">Excel</h2>
                    </div>
                    <div class="upload-card-body">
                        <div class="upload-dropzone" id="welcomeExcelDropzone">
                            <div class="dropzone-icon">
                                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA1CAYAAADh5qNwAAAACXBIWXMAAAsTAAALEwEAmpwYAAADZUlEQVR4nO3aS2jTcBwH8Hrx4kmci/jWsYsXXyAePMiGB3G7uYMoguKyudfFQX2B6BA3D+6wiQdFDyrIZCKCqIdmHZ2be7MpPta6Ura1S5r/v83W9d38JNENdenov02ytPQH38ufJvTTJP/88m9MpnzlQPn9/iKMcQ1CyKxFWJZt1BWEMS5HCAURQqBVZmZmwOVyDekCAoA1CCG3lqBFlN1u1weGENqmNehvlC4wjuOK9Ub9gQ3nHMquJYxbRZRmMC4JKhaLgSiKRAmHw8QoTWBcElQoFIJIJEKUQCCQFOV2u5OipDidzuGsO/04jlsRpSqM0wklxePxgMPh0B7G6YhaDMuyMDs7mzQej6dcE5R0fSwsLBBlbm5OFTTG+IQmKGk2I61oNGpsFPq9c6KodXpiLVFq5Z1rEOrHHsHZkbaUsr/HbCtk6A6KoZ9TDN2wp6NiraFQnc4e2MRUAcXQaafQUvnSUKhTQ60ZgSgpFlrcbru43jBt0vH+28u+5NH+m1Ax2gqH+q4ujW3uqoaTo/fk8S1d1cu2KbBWFWeMCgaD8pckyfz8fEqosuEWiIsJmArxsLu7Xh5rcnTKM+gzt03xaKmCUitKKCntrvcy4uGUBY58ugHhRBQmgywUdTdkL2qbtQa+BqYhIYoyJpqIwbFB5c9S2YKSUjrQJKOkap58veJkUaAGShAE+Rohid/vJ0I1fn+61I0w6MuKU3+BGii12qRkqMN91yEQDwMbEaDf75C3vzbxQluUz+eTjxZJlFolJZQ0ZQ8JP0EEEU6PtcG+j2bwRQMQScSgZOBWdl5TdyffyEfm8XTX0tj5zw/ksR8BN+yw1mYf6kDvZfnGu9Va88/4wd4r8rjhUedG7qvQJlXGqA9n1mWMkhZSpFaJJFIX8v9+bNPjsNNalxGqkKHvpAzSAyVl3OOA9om30PLtVUopG2h+QjG0eaOlspGyXCghAulx+uXsQyLKo5B2qHRuvqRRaquQ0VaT0inpx9MNJaTR0JIm2Tohzl9TCpVHoSxHhdL4f4o00mKN0uMK1gqVzhIZaeLxuL6zH8rF0w/lUchYKKTTGy8k8Xq9pVnxblKq4Xk+LAjCBlOmhTEu0/otshRBcZ7n60xqlc/n2+X1emt5nm9ejSCELmGM96oGypfJWPUL5sWswEbVVLEAAAAASUVORK5CYII=" alt="Excel Icon">
                            </div>
                            <p class="dropzone-text">Arraste seu arquivo Excel aqui</p>
                            <p class="dropzone-subtext">ou clique para selecionar</p>
                            <input type="file" id="welcomeExcelInput" accept=".xlsx,.xls" hidden>
                            <button class="btn-upload" onclick="document.getElementById('welcomeExcelInput').click()">
                                Selecionar Arquivo
                            </button>
                        </div>
                        <div class="upload-status" id="welcomeExcelStatus" style="display: none;">
                            <div class="status-icon success-icon">‚úì</div>
                            <div class="status-info">
                                <p class="status-filename" id="welcomeExcelFilename"></p>
                                <p class="status-size" id="welcomeExcelSize"></p>
                            </div>
                            <button class="btn-remove" onclick="resetWelcomeExcel()">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 48 48">
                                    <linearGradient id="btnRemoveExcelGr1" x1="7.534" x2="27.557" y1="7.534" y2="27.557" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#f44f5a"></stop><stop offset=".443" stop-color="#ee3d4a"></stop><stop offset="1" stop-color="#e52030"></stop></linearGradient><path fill="url(#btnRemoveExcelGr1)" d="M42.42,12.401c0.774-0.774,0.774-2.028,0-2.802L38.401,5.58c-0.774-0.774-2.028-0.774-2.802,0	L24,17.179L12.401,5.58c-0.774-0.774-2.028-0.774-2.802,0L5.58,9.599c-0.774,0.774-0.774,2.028,0,2.802L17.179,24L5.58,35.599	c-0.774,0.774-0.774,2.028,0,2.802l4.019,4.019c0.774,0.774,2.028,0.774,2.802,0L42.42,12.401z"></path><linearGradient id="btnRemoveExcelGr2" x1="27.373" x2="40.507" y1="27.373" y2="40.507" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#a8142e"></stop><stop offset=".179" stop-color="#ba1632"></stop><stop offset=".243" stop-color="#c21734"></stop></linearGradient><path fill="url(#btnRemoveExcelGr2)" d="M24,30.821L35.599,42.42c0.774,0.774,2.028,0.774,2.802,0l4.019-4.019	c0.774-0.774,0.774-2.028,0-2.802L30.821,24L24,30.821z"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="upload-card-footer">
                        <p class="upload-hint">Formatos aceitos: .xlsx, .xls</p>
                    </div>
                </div>

                <!-- Template Upload Area -->
                <div class="upload-card" id="welcomeTemplateCard">
                    <div class="upload-card-header">
                        <h2 class="upload-card-title">Template</h2>
                        <!-- Use Default Template Checkbox -->
                        <label class="checkbox-label checkbox-header">
                            <input type="checkbox" id="useDefaultTemplate" onchange="toggleDefaultTemplate()">
                            <span>Usar padr√£o</span>
                        </label>
                    </div>
                    <div class="upload-card-body">
                        <div class="upload-dropzone" id="welcomeTemplateDropzone">
                            <div class="dropzone-icon">
                                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA1CAYAAADh5qNwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC4klEQVR4nO3aMU/bQBQH8Kjd+ymKurR7h46ou20FlAxAQV0oDAFBBwYGGCoRmJAygIQAUSEGJKZWdGBgQFRIfAAjAUIojnnnQCCOfXf2q+yoCRWtmgSfDcFP+i+nk3I/3z3HwyUScbVp6brecXFx8YkQ8llENE3LhAoCAAUALEIIisr5+TmenJzshQJCxOcAACJBv1GqqoYD03W9QzToNioUmGEYb8JGeTk9Pd1vO5RQmBEhShUFixqlqioeHx//bBmAk5PPqCR9tWWZUVnGIGKn01ja2roXSr3Py4NK0tugMH/Aenv/i9J1HY+OjoKHMUV5X1uMoiBfXa1mYQHZ0JA/zsbHq2PLy8hnZ5GmUtX5qVR9vpeZmTqsu7uhI5jP54OHsduoZBKRUuS5HPKVFXQJQTY8jHxpCd2DAx/qfP+Obj6PdGAAaV8fYqlUnZ/LIZuaahrlBQCwUCigpmn/DAB0to4ql2sLc7a3kc/P+yhnY6M2ztfX0dnc9FGurv/9CDaBahDe2TrKtpFns/6TdwGQjYzcRWWz6OzsVHeKc3Q1zQ+fm3ugKEr9XeBra8jGxqqI2yhFQWd3F/ni4iPaqXL9+NV2xuupszN09vf9fvJQtKvrkaAUBdno6N0F9vf7u+YdRdrTUx9PJpFlMg8PZSWTr2xZdoP+n7IGB6NDeWVL0gdblr/ZkvTDi5VO75kTE9hypqexeHgYLSqqb78YBTHqbsUoEqPwwaFKpRJaliU019fX4aIopSi6OOfhoorFIt7c3AjN5eVl3FMN15NClctlZIwJjWma7feiYIyFizIMA6+uroTGMIy4pxquJ4WqVCrouq7QWJYVLsr7QdFFKQ3/+HmNLDIk7qmAUN73n8iQsFG2bbdfT5mmiY7jCE2lUol7quGKUeSRoPSQbrw0E8Mw3j2Ku0lNxASAF4kgbpERQipRgwCAEUI+JoKqQqHwEgCGAOBLRMkQQl4HBoorEV39Ao9Z9ZpvVIYRAAAAAElFTkSuQmCC" alt="PDF Icon">
                            </div>
                            <p class="dropzone-text">Arraste seu template PDF aqui</p>
                            <p class="dropzone-subtext">ou clique para selecionar</p>
                            <input type="file" id="welcomeTemplateInput" accept=".pdf" hidden>
                            <button class="btn-upload" onclick="document.getElementById('welcomeTemplateInput').click()">
                                Selecionar Arquivo
                            </button>
                        </div>
                        <div class="upload-status" id="welcomeTemplateStatus" style="display: none;">
                            <div class="status-icon success-icon">‚úì</div>
                            <div class="status-info">
                                <p class="status-filename" id="welcomeTemplateFilename"></p>
                                <p class="status-size" id="welcomeTemplateSize"></p>
                            </div>
                            <button class="btn-remove" onclick="resetWelcomeTemplate()">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 48 48">
                                    <linearGradient id="btnRemoveTemplateGr1" x1="7.534" x2="27.557" y1="7.534" y2="27.557" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#f44f5a"></stop><stop offset=".443" stop-color="#ee3d4a"></stop><stop offset="1" stop-color="#e52030"></stop></linearGradient><path fill="url(#btnRemoveTemplateGr1)" d="M42.42,12.401c0.774-0.774,0.774-2.028,0-2.802L38.401,5.58c-0.774-0.774-2.028-0.774-2.802,0	L24,17.179L12.401,5.58c-0.774-0.774-2.028-0.774-2.802,0L5.58,9.599c-0.774,0.774-0.774,2.028,0,2.802L17.179,24L5.58,35.599	c-0.774,0.774-0.774,2.028,0,2.802l4.019,4.019c0.774,0.774,2.028,0.774,2.802,0L42.42,12.401z"></path><linearGradient id="btnRemoveTemplateGr2" x1="27.373" x2="40.507" y1="27.373" y2="40.507" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#a8142e"></stop><stop offset=".179" stop-color="#ba1632"></stop><stop offset=".243" stop-color="#c21734"></stop></linearGradient><path fill="url(#btnRemoveTemplateGr2)" d="M24,30.821L35.599,42.42c0.774,0.774,2.028,0.774,2.802,0l4.019-4.019	c0.774-0.774,0.774-2.028,0-2.802L30.821,24L24,30.821z"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="upload-card-footer">
                        <p class="upload-hint">Formato aceito: .pdf</p>
                    </div>
                </div>
            </div>

            <!-- Action Button -->
            <div class="welcome-actions">
                <button class="btn-start" id="btnStart" onclick="startApplication()" disabled>
                    <span>Iniciar Aplica√ß√£o</span>
                </button>
                <p class="welcome-note">Carregue ambos os arquivos para continuar</p>
            </div>
        </div>
    </div>

    <div class="workbench">
        <!-- Header -->
        <header class="workbench-header">
            <div class="header-logo">
                <img src="src/iconlogo.svg" alt="BdayPDF Creator Icon" class="logo-icon">
                <img src="src/textlogo.svg" alt="BdayPDF Creator Text" class="logo-text">
            </div>
            <button class="btn btn-generate btn-primary" id="generateBatchBtn" onclick="generateAllCards()">
                <span class="btn-icon"><img src="data:image/png;base64,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" alt="run-command"></span>
                <span>Gerar em lote</span>
            </button>
        </header>

        <!-- Main Body -->
        <main class="app-body">
            <!-- Left Toolbar -->
            <aside class="toolbar">
                <div class="toolbar-item" data-tool="select" title="Sele√ß√£o de Campos">
                    <div class="toolbar-icon">üñ±Ô∏è</div>
                    <span class="toolbar-label">Select</span>
                </div>
                <div class="toolbar-item" data-tool="text" title="Edi√ß√£o de Texto">
                    <div class="toolbar-icon">‚úèÔ∏è</div>
                    <span class="toolbar-label">Text</span>
                </div>
                <div class="toolbar-item" data-tool="zoom" title="Zoom">
                    <div class="toolbar-icon">üîç</div>
                    <span class="toolbar-label">Zoom</span>
                </div>
            </aside>

            <!-- Center Canvas -->
            <section class="canvas-area">
                <div class="canvas-container">
                    <div class="canvas-header">
                        <span class="canvas-title">PDF Preview</span>
                        <div class="canvas-zoom-controls">
                            <button class="zoom-btn" onclick="zoomOut()">‚àí</button>
                            <span class="zoom-level" id="zoomLevel">100%</span>
                            <button class="zoom-btn" onclick="zoomIn()">+</button>
                        </div>
                    </div>
                    <div class="canvas-content" id="canvasContent">
                        <!-- PDF Preview Frame -->
                        <iframe id="pdfPreviewFrame" class="pdf-preview-frame"></iframe>
                        <!-- Placeholder when no template is loaded -->
                        <div class="canvas-placeholder" id="canvasPlaceholder">
                            <div class="placeholder-icon">üìÑ</div>
                            <p>Carregue um template PDF para visualizar</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Right Properties Panel -->
            <aside class="properties-panel">
                <!-- Upload Section -->
                <div class="panel-section">
                    <h3 class="panel-title">Upload Excel</h3>
                    <div class="upload-box" id="uploadBox">
                        <div class="upload-icon"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA1CAYAAADh5qNwAAAACXBIWXMAAAsTAAALEwEAmpwYAAADZUlEQVR4nO3aS2jTcBwH8Hrx4kmci/jWsYsXXyAePMiGB3G7uYMoguKyudfFQX2B6BA3D+6wiQdFDyrIZCKCqIdmHZ2be7MpPta6Ura1S5r/v83W9d38JNENdenov02ytPQH38ufJvTTJP/88m9MpnzlQPn9/iKMcQ1CyKxFWJZt1BWEMS5HCAURQqBVZmZmwOVyDekCAoA1CCG3lqBFlN1u1weGENqmNehvlC4wjuOK9Ub9gQ3nHMquJYxbRZRmMC4JKhaLgSiKRAmHw8QoTWBcElQoFIJIJEKUQCCQFOV2u5OipDidzuGsO/04jlsRpSqM0wklxePxgMPh0B7G6YhaDMuyMDs7mzQej6dcE5R0fSwsLBBlbm5OFTTG+IQmKGk2I61oNGpsFPq9c6KodXpiLVFq5Z1rEOrHHsHZkbaUsr/HbCtk6A6KoZ9TDN2wp6NiraFQnc4e2MRUAcXQaafQUvnSUKhTQ60ZgSgpFlrcbru43jBt0vH+28u+5NH+m1Ax2gqH+q4ujW3uqoaTo/fk8S1d1cu2KbBWFWeMCgaD8pckyfz8fEqosuEWiIsJmArxsLu7Xh5rcnTKM+gzt03xaKmCUitKKCntrvcy4uGUBY58ugHhRBQmgywUdTdkL2qbtQa+BqYhIYoyJpqIwbFB5c9S2YKSUjrQJKOkap58veJkUaAGShAE+Rohid/vJ0I1fn+61I0w6MuKU3+BGii12qRkqMN91yEQDwMbEaDf75C3vzbxQluUz+eTjxZJlFolJZQ0ZQ8JP0EEEU6PtcG+j2bwRQMQScSgZOBWdl5TdyffyEfm8XTX0tj5zw/ksR8BN+yw1mYf6kDvZfnGu9Va88/4wd4r8rjhUedG7qvQJlXGqA9n1mWMkhZSpFaJJFIX8v9+bNPjsNNalxGqkKHvpAzSAyVl3OOA9om30PLtVUopG2h+QjG0eaOlspGyXCghAulx+uXsQyLKo5B2qHRuvqRRaquQ0VaT0inpx9MNJaTR0JIm2Tohzl9TCpVHoSxHhdL4f4o00mKN0uMK1gqVzhIZaeLxuL6zH8rF0w/lUchYKKTTGy8k8Xq9pVnxblKq4Xk+LAjCBlOmhTEu0/otshRBcZ7n60xqlc/n2+X1emt5nm9ejSCELmGM96oGypfJWPUL5sWswEbVVLEAAAAASUVORK5CYII=" alt="Excel Icon"></div>
                        <p>Arraste ou clique</p>
                        <input type="file" id="fileInput" accept=".xlsx,.xls" hidden>
                        <button class="btn btn-sm" onclick="document.getElementById('fileInput').click()">
                            Selecionar
                        </button>
                    </div>
                    <div class="file-info" id="fileInfo" style="display: none;">
                        <div class="file-icon"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA1CAYAAADh5qNwAAAACXBIWXMAAAsTAAALEwEAmpwYAAADZUlEQVR4nO3aS2jTcBwH8Hrx4kmci/jWsYsXXyAePMiGB3G7uYMoguKyudfFQX2B6BA3D+6wiQdFDyrIZCKCqIdmHZ2be7MpPta6Ura1S5r/v83W9d38JNENdenov02ytPQH38ufJvTTJP/88m9MpnzlQPn9/iKMcQ1CyKxFWJZt1BWEMS5HCAURQqBVZmZmwOVyDekCAoA1CCG3lqBFlN1u1weGENqmNehvlC4wjuOK9Ub9gQ3nHMquJYxbRZRmMC4JKhaLgSiKRAmHw8QoTWBcElQoFIJIJEKUQCCQFOV2u5OipDidzuGsO/04jlsRpSqM0wklxePxgMPh0B7G6YhaDMuyMDs7mzQej6dcE5R0fSwsLBBlbm5OFTTG+IQmKGk2I61oNGpsFPq9c6KodXpiLVFq5Z1rEOrHHsHZkbaUsr/HbCtk6A6KoZ9TDN2wp6NiraFQnc4e2MRUAcXQaafQUvnSUKhTQ60ZgSgpFlrcbru43jBt0vH+28u+5NH+m1Ax2gqH+q4ujW3uqoaTo/fk8S1d1cu2KbBWFWeMCgaD8pckyfz8fEqosuEWiIsJmArxsLu7Xh5rcnTKM+gzt03xaKmCUitKKCntrvcy4uGUBY58ugHhRBQmgywUdTdkL2qbtQa+BqYhIYoyJpqIwbFB5c9S2YKSUjrQJKOkap58veJkUaAGShAE+Rohid/vJ0I1fn+61I0w6MuKU3+BGii12qRkqMN91yEQDwMbEaDf75C3vzbxQluUz+eTjxZJlFolJZQ0ZQ8JP0EEEU6PtcG+j2bwRQMQScSgZOBWdl5TdyffyEfm8XTX0tj5zw/ksR8BN+yw1mYf6kDvZfnGu9Va88/4wd4r8rjhUedG7qvQJlXGqA9n1mWMkhZSpFaJJFIX8v9+bNPjsNNalxGqkKHvpAzSAyVl3OOA9om30PLtVUopG2h+QjG0eaOlspGyXCghAulx+uXsQyLKo5B2qHRuvqRRaquQ0VaT0inpx9MNJaTR0JIm2Tohzl9TCpVHoSxHhdL4f4o00mKN0uMK1gqVzhIZaeLxuL6zH8rF0w/lUchYKKTTGy8k8Xq9pVnxblKq4Xk+LAjCBlOmhTEu0/otshRBcZ7n60xqlc/n2+X1emt5nm9ejSCELmGM96oGypfJWPUL5sWswEbVVLEAAAAASUVORK5CYII=" alt="Excel Icon"></div>
                        <div class="file-details">
                            <p class="file-name" id="fileName"></p>
                            <p class="file-size" id="fileSize"></p>
                        </div>
                        <button class="btn-remove" style="width: 26px; height: 26px; min-width: 10px; min-height: 10px; padding: 3px 7px;" onclick="resetUpload()">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 48 48" style="width: 16px; height: 16px;">
                                <linearGradient id="btnRemoveExcelMainGr1" x1="7.534" x2="27.557" y1="7.534" y2="27.557" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#f44f5a"></stop><stop offset=".443" stop-color="#ee3d4a"></stop><stop offset="1" stop-color="#e52030"></stop></linearGradient><path fill="url(#btnRemoveExcelMainGr1)" d="M42.42,12.401c0.774-0.774,0.774-2.028,0-2.802L38.401,5.58c-0.774-0.774-2.028-0.774-2.802,0	L24,17.179L12.401,5.58c-0.774-0.774-2.028-0.774-2.802,0L5.58,9.599c-0.774,0.774-0.774,2.028,0,2.802L17.179,24L5.58,35.599	c-0.774,0.774-0.774,2.028,0,2.802l4.019,4.019c0.774,0.774,2.028,0.774,2.802,0L42.42,12.401z"></path><linearGradient id="btnRemoveExcelMainGr2" x1="27.373" x2="40.507" y1="27.373" y2="40.507" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#a8142e"></stop><stop offset=".179" stop-color="#ba1632"></stop><stop offset=".243" stop-color="#c21734"></stop></linearGradient><path fill="url(#btnRemoveExcelMainGr2)" d="M24,30.821L35.599,42.42c0.774,0.774,2.028,0.774,2.802,0l4.019-4.019	c0.774-0.774,0.774-2.028,0-2.802L30.821,24L24,30.821z"></path>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- PDF Template Section -->
                <div class="panel-section">
                    <div class="panel-section-header">
                        <h3 class="panel-title">Template PDF</h3>
                        <!-- Use Default Template Checkbox -->
                        <label class="checkbox-label checkbox-header">
                            <input type="checkbox" id="useDefaultTemplateMain" onchange="toggleDefaultTemplateMain()">
                            <span>Usar padr√£o</span>
                        </label>
                    </div>
                    <div class="upload-box" id="pdfTemplateBox">
                        <div class="upload-icon"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA1CAYAAADh5qNwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC4klEQVR4nO3aMU/bQBQH8Kjd+ymKurR7h46ou20FlAxAQV0oDAFBBwYGGCoRmJAygIQAUSEGJKZWdGBgQFRIfAAjAUIojnnnQCCOfXf2q+yoCRWtmgSfDcFP+i+nk3I/3z3HwyUScbVp6brecXFx8YkQ8llENE3LhAoCAAUALEIIisr5+TmenJzshQJCxOcAACJBv1GqqoYD03W9QzToNioUmGEYb8JGeTk9Pd1vO5RQmBEhShUFixqlqioeHx//bBmAk5PPqCR9tWWZUVnGIGKn01ja2roXSr3Py4NK0tugMH/Aenv/i9J1HY+OjoKHMUV5X1uMoiBfXa1mYQHZ0JA/zsbHq2PLy8hnZ5GmUtX5qVR9vpeZmTqsu7uhI5jP54OHsduoZBKRUuS5HPKVFXQJQTY8jHxpCd2DAx/qfP+Obj6PdGAAaV8fYqlUnZ/LIZuaahrlBQCwUCigpmn/DAB0to4ql2sLc7a3kc/P+yhnY6M2ztfX0dnc9FGurv/9CDaBahDe2TrKtpFns/6TdwGQjYzcRWWz6OzsVHeKc3Q1zQ+fm3ugKEr9XeBra8jGxqqI2yhFQWd3F/ni4iPaqXL9+NV2xuupszN09vf9fvJQtKvrkaAUBdno6N0F9vf7u+YdRdrTUx9PJpFlMg8PZSWTr2xZdoP+n7IGB6NDeWVL0gdblr/ZkvTDi5VO75kTE9hypqexeHgYLSqqb78YBTHqbsUoEqPwwaFKpRJaliU019fX4aIopSi6OOfhoorFIt7c3AjN5eVl3FMN15NClctlZIwJjWma7feiYIyFizIMA6+uroTGMIy4pxquJ4WqVCrouq7QWJYVLsr7QdFFKQ3/+HmNLDIk7qmAUN73n8iQsFG2bbdfT5mmiY7jCE2lUol7quGKUeSRoPSQbrw0E8Mw3j2Ku0lNxASAF4kgbpERQipRgwCAEUI+JoKqQqHwEgCGAOBLRMkQQl4HBoorEV39Ao9Z9ZpvVIYRAAAAAElFTkSuQmCC" alt="PDF Icon"></div>
                        <p>Arraste ou clique</p>
                        <input type="file" id="pdfTemplateInput" accept=".pdf" hidden>
                        <button class="btn btn-sm" onclick="document.getElementById('pdfTemplateInput').click()">
                            Selecionar
                        </button>
                    </div>
                    <div class="file-info" id="pdfTemplateInfo" style="display: none;">
                        <div class="file-icon"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA1CAYAAADh5qNwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC4klEQVR4nO3aMU/bQBQH8Kjd+ymKurR7h46ou20FlAxAQV0oDAFBBwYGGCoRmJAygIQAUSEGJKZWdGBgQFRIfAAjAUIojnnnQCCOfXf2q+yoCRWtmgSfDcFP+i+nk3I/3z3HwyUScbVp6brecXFx8YkQ8llENE3LhAoCAAUALEIIisr5+TmenJzshQJCxOcAACJBv1GqqoYD03W9QzToNioUmGEYb8JGeTk9Pd1vO5RQmBEhShUFixqlqioeHx//bBmAk5PPqCR9tWWZUVnGIGKn01ja2roXSr3Py4NK0tugMH/Aenv/i9J1HY+OjoKHMUV5X1uMoiBfXa1mYQHZ0JA/zsbHq2PLy8hnZ5GmUtX5qVR9vpeZmTqsu7uhI5jP54OHsduoZBKRUuS5HPKVFXQJQTY8jHxpCd2DAx/qfP+Obj6PdGAAaV8fYqlUnZ/LIZuaahrlBQCwUCigpmn/DAB0to4ql2sLc7a3kc/P+yhnY6M2ztfX0dnc9FGurv/9CDaBahDe2TrKtpFns/6TdwGQjYzcRWWz6OzsVHeKc3Q1zQ+fm3ugKEr9XeBra8jGxqqI2yhFQWd3F/ni4iPaqXL9+NV2xuupszN09vf9fvJQtKvrkaAUBdno6N0F9vf7u+YdRdrTUx9PJpFlMg8PZSWTr2xZdoP+n7IGB6NDeWVL0gdblr/ZkvTDi5VO75kTE9hypqexeHgYLSqqb78YBTHqbsUoEqPwwaFKpRJaliU019fX4aIopSi6OOfhoorFIt7c3AjN5eVl3FMN15NClctlZIwJjWma7feiYIyFizIMA6+uroTGMIy4pxquJ4WqVCrouq7QWJYVLsr7QdFFKQ3/+HmNLDIk7qmAUN73n8iQsFG2bbdfT5mmiY7jCE2lUol7quGKUeSRoPSQbrw0E8Mw3j2Ku0lNxASAF4kgbpERQipRgwCAEUI+JoKqQqHwEgCGAOBLRMkQQl4HBoorEV39Ao9Z9ZpvVIYRAAAAAElFTkSuQmCC" alt="PDF Icon"></div>
                        <div class="file-details">
                            <p class="file-name" id="pdfTemplateName"></p>
                            <p class="file-size" id="pdfTemplateSize"></p>
                        </div>
                        <button class="btn-remove" style="width: 26px; height: 26px; min-width: 10px; min-height: 10px; font-size: 15px; padding: 3px 7px;" onclick="resetPDFTemplate()">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 48 48" style="width: 16px; height: 16px;">
                                <linearGradient id="btnRemoveTemplateMainGr1" x1="7.534" x2="27.557" y1="7.534" y2="27.557" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#f44f5a"></stop><stop offset=".443" stop-color="#ee3d4a"></stop><stop offset="1" stop-color="#e52030"></stop></linearGradient><path fill="url(#btnRemoveTemplateMainGr1)" d="M42.42,12.401c0.774-0.774,0.774-2.028,0-2.802L38.401,5.58c-0.774-0.774-2.028-0.774-2.802,0	L24,17.179L12.401,5.58c-0.774-0.774-2.028-0.774-2.802,0L5.58,9.599c-0.774,0.774-0.774,2.028,0,2.802L17.179,24L5.58,35.599	c-0.774,0.774-0.774,2.028,0,2.802l4.019,4.019c0.774,0.774,2.028,0.774,2.802,0L42.42,12.401z"></path><linearGradient id="btnRemoveTemplateMainGr2" x1="27.373" x2="40.507" y1="27.373" y2="40.507" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#a8142e"></stop><stop offset=".179" stop-color="#ba1632"></stop><stop offset=".243" stop-color="#c21734"></stop></linearGradient><path fill="url(#btnRemoveTemplateMainGr2)" d="M24,30.821L35.599,42.42c0.774,0.774,2.028,0.774,2.802,0l4.019-4.019	c0.774-0.774,0.774-2.028,0-2.802L30.821,24L24,30.821z"></path>
                            </svg>
                        </button>
                    </div>
                    <!-- Template Selector (shown when default template is used) -->
                    <div class="template-selector" id="templateSelector" style="display: none;">
                        <div class="template-selector-header">
                            <label class="checkbox-label checkbox-header">
                                <input type="checkbox" id="useTemplateSemAssinatura" onchange="toggleTemplateSemAssinatura()">
                                <span>Sem assinatura</span>
                            </label>
                        </div>
                        <label for="defaultTemplateSelect">Selecione o template padr√£o:</label>
                        <select id="defaultTemplateSelect" onchange="changeDefaultTemplate()">
                            <option value="Template.pdf">Template (padr√£o)</option>
                            <option value="Template_sem_assinatura.pdf">Template sem assinatura</option>
                            <option value="Template2.pdf">Template 2</option>
                        </select>
                    </div>
                </div>

                <!-- Field Positioning -->
                <div class="panel-section accordion-section" id="fieldPositioning" style="display: none;">
                    <h3 class="panel-title accordion-toggle">Posicionar Campos <button class="accordion-icon btn-image-action"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABz0lEQVR4nO2Uy0oCURyH5wkSKrIh1G7OTDebNj1Cuyh6g96lFm2SFmVKEGohZRdCky70AC2ilVFUk+I54zRq7dqEnAiamNJyrDM6A/8Pfvvv+8M5DAMAAAAAAAAAwH9xRzOsK5JLuMPoxR1BhNbYUIbaOoMSafdfKY65c7EiwBVGSZriZgSwH2tfTCuVAZFc1i4BzuXb14oAzzoWXGEkWz3AuXJfdsxfzFR9B2ZENEzerAhqDzhwV1vejAhq8guX04bkaUc0RV6jO4r4/0Y0TZ5WRFPl9RGeKMaeDUzq3Z/kV+/Lbf40HXl9RM8Gxj2bmNSzuuWDUrlt6XqKqvxnxDbie2My7o3JxOjqCgg+lDsCkjnyXyK2ZNy3lSdGZjzgwXx5DX4b8f3xPPbGFVJrhi8fapC8hrCnct6dPOZ2FfLbDF0+lG2svD5C2FOwsP9Ifppl5fURAwePeOBAJdX2m7xzNTvJWAHhUOUGEyoeTBTI91leXsN3qHJDyQIaThaJfraQ1xATqnc4VUAjqSLRZht5DfFE9Y4clZDvqETeZyt5Dd+pyo0elzLiydPHP595ZdekCcZOjKeKLWNnz7OdQWmtNXDT1WwfAAAAAGCsyBurBlk9BFq7AAAAAABJRU5ErkJggg==" alt="sort-down"></button></h3>

                    <div class="panel-content">
                        <div class="field-groups">
                            <!-- Nome Field -->
                            <div class="field-group nome">
                                <h4>Nome</h4>
                                <div class="field-coordinates">
                                    <div class="coord-input">
                                        <label>X:</label>
                                        <input type="number" id="nomeX" value="105" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Y:</label>
                                        <input type="number" id="nomeY" value="380" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Tamanho:</label>
                                        <input type="number" id="nomeSize" value="40" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Alinhar:</label>
                                        <select id="nomeAlign">
                                            <option value="left">Esq</option>
                                            <option value="center">Cen</option>
                                            <option value="right">Dir</option>
                                        </select>
                                    </div>
                                    <button class="btn btn-sm btn-primary" onclick="updateFieldPosition('Nome')">Atualizar</button>
                                </div>
                            </div>

                            <!-- Vocativo Field -->
                            <div class="field-group">
                                <h4>Vocativo</h4>
                                <div class="field-coordinates">
                                    <div class="coord-input">
                                        <label>X:</label>
                                        <input type="number" id="vocativoX" value="115" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Y:</label>
                                        <input type="number" id="vocativoY" value="425" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Tamanho:</label>
                                        <input type="number" id="vocativoSize" value="20" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Alinhar:</label>
                                        <select id="vocativoAlign">
                                            <option value="left">Esq</option>
                                            <option value="center">Cen</option>
                                            <option value="right">Dir</option>
                                        </select>
                                    </div>
                                    <button class="btn btn-sm btn-primary" onclick="updateFieldPosition('Vocativo')">Atualizar</button>
                                </div>
                            </div>

                            <!-- Data Field -->
                            <div class="field-group">
                                <h4>Data</h4>
                                <div class="field-coordinates">
                                    <div class="coord-input">
                                        <label>X:</label>
                                        <input type="number" id="dataX" value="765" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Y:</label>
                                        <input type="number" id="dataY" value="490" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Tamanho:</label>
                                        <input type="number" id="dataSize" value="18" step="1">
                                    </div>
                                    <div class="coord-input">
                                        <label>Alinhar:</label>
                                        <select id="dataAlign">
                                            <option value="left">Esq</option>
                                            <option value="center">Cen</option>
                                            <option value="right">Dir</option>
                                        </select>
                                    </div>
                                    <button class="btn btn-sm btn-primary" onclick="updateFieldPosition('Data')">Atualizar</button>
                                </div>
                            </div>
                        </div>

                        <div class="field-list" id="fieldList">
                            <!-- Field positions will be listed here -->
                        </div>
                    </div>
                </div>

                <!-- Data Preview Section -->
                <div class="panel-section" id="dataPreviewSection" style="display: none;">
                    <h3 class="panel-title">Pr√©via dos Dados</h3>
                    <div class="data-summary" id="dataSummary"></div>

                    <!-- Month Tabs -->
                    <div class="month-tabs" id="monthTabs"></div>

                    <!-- Data Table -->
                </div>

                <!-- Results Section -->
                <div class="panel-section" id="resultsPanelSection" style="display: none;">
                    <h3 class="panel-title">Baixar em lote</h3>
                    <div class="results-summary" id="resultsSummary"></div>
                    <div class="results-list" id="resultsList"></div>
                    <div class="panel-actions">
                        <button class="btn btn-primary" onclick="downloadAllCards()">
                            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACtklEQVR4nO2Y/0sTYRzHPxhMQX8oszIhCsREyAgrW1FEREVIRERUSEkQ1R+REBE0oi+om7gkoS4IyhiF/lQZhO60mjvnUisKNNtYtP0kDOvaO25tMZjPPbc6njm4N7x4eI7PG+7F3fPDHZEVK1asWDErYYmawhLNhiXCvxC6R4mwRO9DErVQPjLdQ19meghmMH2HLgkX+HSbYCpucggVmHIRzGbSRTeD3VQuRGC8jWA2kb7NwOR5YOoCE8VViVeXCbKjRHfuh3Ja/f5sVytTYPQGwUzCT7WbP8dF6cwQ4MzO+5tVpsCIg2AWs54GYOKsLl5HcfLGtSfAm82EKTB4hfC/DF8rxtcnjcDEGS5ySmCsc5Wh+TRMgZ/+E8C7FuEozpWpV6jY0DxTAMFTyAeKK0PAwLyOQDNE4nXYUmdgRU49tsD4SYhETp8BTSCHno7AceQDxVmReoVshubZAoFjyAdKpoCBebbA2FGIxJs+A86KnHo6AkcgEjklMOZanlOPLaAcRj5QOsr/vEJXbYbm2QL+Q8gHijNDwMC8jkATCgFiJTF6EKL45duP6KMyRO7TX7S9dp3X1RE4AFHMD9kRuktZzA/auV22gG8fRDH3vH7Bb+m5F/XcLlvg7V6IItZXjc/dlEWsv5rb1RHYA1FEelfjYxdlEXlcxe2yBd7shiimpaXaB38WM9Iybpct8HonRPHBXYJgO+GbZx1UeTsinrXJvXad19UR2AFRBNqKoNwiqPK25F5btX2gfQm3yxYYsUMUk12l8F0nhHrXQJW3JldtP+Uu43bZAsONEEWsf/2CfzO067yujsAWiCTaV4NARylGHEXJNdpfY6jHFpAbUAgQW2ATCgFiJf6yTk14N2IxEx+oY/9aDD2oao0P1KqJoQ1YjMQHatXZh5UXmQJWrFixYoVyzG8y4mrP9/rQQwAAAABJRU5ErkJggg==" alt="zip-file"> Baixar ZIP
                        </button>
                        <button class="btn btn-secondary" onclick="resetAll()">
                            <img src="data:image/png;base64,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" alt="reset"> Resetar
                        </button>
                    </div>
                </div>
            </aside>
        </main>

        <!-- Progress Modal -->
        <div class="progress-modal" id="progressModal" style="display: none;">
            <div class="progress-content">
                <h3>üîÑ Gerando Cart√µes...</h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p class="progress-text" id="progressText">0 de 0 cart√µes gerados</p>
            </div>
        </div>

        <!-- Month Selection Modal -->
        <div class="month-modal" id="monthModal" style="display: none;">
            <div class="month-modal-content">
                <div class="month-modal-header">
                    <button class="month-modal-nav-btn" onclick="navigateMonth(-1)" title="M√™s Anterior">
                        <img src="https://img.icons8.com/fluency/48/back.png" alt="back" class="nav-icon" />
                    </button>
                    <h3 id="monthModalTitle">Sele√ß√£o de Cart√µes</h3>
                    <button class="month-modal-nav-btn" onclick="navigateMonth(1)" title="Pr√≥ximo M√™s">
                        <img src="https://img.icons8.com/fluency/48/back.png" alt="back" class="nav-icon rotate-180" />
                    </button>
                    <button class="btn-remove" onclick="closeMonthModal()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 48 48">
                            <linearGradient id="btnRemoveMonthModalGr1" x1="7.534" x2="27.557" y1="7.534" y2="27.557" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#f44f5a"></stop><stop offset=".443" stop-color="#ee3d4a"></stop><stop offset="1" stop-color="#e52030"></stop></linearGradient><path fill="url(#btnRemoveMonthModalGr1)" d="M42.42,12.401c0.774-0.774,0.774-2.028,0-2.802L38.401,5.58c-0.774-0.774-2.028-0.774-2.802,0	L24,17.179L12.401,5.58c-0.774-0.774-2.028-0.774-2.802,0L5.58,9.599c-0.774,0.774-0.774,2.028,0,2.802L17.179,24L5.58,35.599	c-0.774,0.774-0.774,2.028,0,2.802l4.019,4.019c0.774,0.774,2.028,0.774,2.802,0L42.42,12.401z"></path><linearGradient id="btnRemoveMonthModalGr2" x1="27.373" x2="40.507" y1="27.373" y2="40.507" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#a8142e"></stop><stop offset=".179" stop-color="#ba1632"></stop><stop offset=".243" stop-color="#c21734"></stop></linearGradient><path fill="url(#btnRemoveMonthModalGr2)" d="M24,30.821L35.599,42.42c0.774,0.774,2.028,0.774,2.802,0l4.019-4.019	c0.774-0.774,0.774-2.028,0-2.802L30.821,24L24,30.821z"></path>
                        </svg>
                    </button>
                </div>
                <div class="month-modal-body">
                    <div class="month-modal-summary" id="monthModalSummary"></div>
                    <div class="month-modal-actions">
                        <button class="btn btn-sm btn-secondary" onclick="selectAllInModal()">Selecionar Todos</button>
                        <button class="btn btn-sm btn-secondary" onclick="deselectAllInModal()">Desmarcar Todos</button>
                    </div>
                    <div class="month-modal-table-container">
                        <table class="month-modal-table">
                            <thead>
                                <tr>
                                    <th class="checkbox-column">
                                        <input type="checkbox" id="selectAllModal" onchange="toggleSelectAllModal()">
                                    </th>
                                    <th>Nome</th>
                                    <th>Vocativo</th>
                                    <th>Data</th>
                                    <th>A√ß√£o</th>
                                </tr>
                            </thead>
                            <tbody id="monthModalTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="month-modal-footer">
                    <button class="btn btn-success" onclick="saveModalSelections()">
                        <img src="https://img.icons8.com/fluency/48/checkmark--v1.png" alt="checkmark--v1"
                            class="btn-icon-img" />
                        <span>OK</span>
                    </button>
                    <button class="btn btn-primary" onclick="downloadSelectedFromModal()">
                        <img src="https://img.icons8.com/fluency/48/downloading-updates.png" alt="downloading-updates"
                            class="btn-icon-img" />
                        <span>Baixar Selecionados</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Alert Container -->
    <div class="alert-container" id="alertContainer"></div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://unpkg.com/downloadjs@1.4.7/download.min.js"></script>
    <script src="script.js"></script>
</body>
</html>